all:
  children:
    # defines which host will perform the build
    # only the first host in this group will ever be used
    docker_build_hosts:
      hosts:
        # for these examples we'll build images on the same host ansible is running on
        localhost:
          connection: local

    docker_build_images:

      # each image we want to build is defined as a host, and thus can make use of ansible's variable precedence
      hosts:

        # don't do much other than run splunk
        hello_swarm_forwarder:
          # every image definition must have a version
          version: 1.0.0

        # enable healthcheck for the _internal index
        internal_healthcheck_forwarder:
          # remember every image must have a version number
          version: 1.0.0

          # perform the check every 30 seconds
          healthcheck_interval_seconds: 30

          # in splunk's metrics.log
          # for the per_index_thruput group
          healthcheck_metrics_group: per_index_thruput
          # for the _internal series
          healthcheck_metrics_series: _internal
          # expect to see non-zero thruput no older than 60 seconds
          healthcheck_allowed_age_seconds: 6
